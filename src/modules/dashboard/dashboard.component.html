<div class="dashboard-container">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="header-content">
      <h1>Dashboard</h1>
      <p class="subtitle">Hotel Management System Overview</p>
    </div>
    <div class="action-buttons">
      <button nz-button nzType="primary" (click)="navigateToAddHotel()">
        <span nz-icon nzType="plus"></span>
        Add Hotel
      </button>
      <button nz-button nzType="default" (click)="navigateToAddRoom()">
        <span nz-icon nzType="plus"></span>
        Add Room
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading()" class="loading-state">
    <nz-spin nzSimple [nzSize]="'large'"></nz-spin>
  </div>

  <!-- Error State -->
  <div *ngIf="error()" class="error-state">
    <nz-alert nzType="error" [nzMessage]="error()" nzShowIcon></nz-alert>
    <button nz-button nzType="primary" (click)="loadDashboardStats()" style="margin-top: 16px;">Retry</button>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading() && !error() && stats()" class="dashboard-content">
    <!-- Stats Grid -->
    <div nz-row [nzGutter]="16">
      <div nz-col [nzSpan]="6">
        <nz-card>
          <nz-statistic [nzValue]="stats()!.totalHotels" [nzTitle]="'Total Hotels'" [nzPrefix]="prefixTplHotels"
            [nzSuffix]="''" [nzValueStyle]="{ color: '#3f8600' }"></nz-statistic>
          <ng-template #prefixTplHotels><span nz-icon nzType="home"></span></ng-template>
          <button nz-button nzType="link" (click)="navigateToHotels()">View all</button>
        </nz-card>
      </div>
      <div nz-col [nzSpan]="6">
        <nz-card>
          <nz-statistic [nzValue]="stats()!.totalRooms" [nzTitle]="'Total Rooms'" [nzPrefix]="prefixTplRooms"
            [nzValueStyle]="{ color: '#cf1322' }"></nz-statistic>
          <ng-template #prefixTplRooms><span nz-icon nzType="appstore"></span></ng-template>
          <button nz-button nzType="link" (click)="navigateToRooms()">View all</button>
        </nz-card>
      </div>
      <div nz-col [nzSpan]="6">
        <nz-card>
          <nz-statistic [nzValue]="stats()!.availableRooms" [nzTitle]="'Available Rooms'"
            [nzPrefix]="prefixTplAvailable" [nzValueStyle]="{ color: '#3f8600' }"></nz-statistic>
          <ng-template #prefixTplAvailable><span nz-icon nzType="check-circle"></span></ng-template>
          <nz-progress
            [nzPercent]="stats()!.totalRooms > 0 ? ((stats()!.availableRooms / stats()!.totalRooms * 100) | number:'1.0-0') : 0"
            nzSize="small"></nz-progress>
        </nz-card>
      </div>
      <div nz-col [nzSpan]="6">
        <nz-card>
          <nz-statistic [nzValue]="stats()!.bookedRooms" [nzTitle]="'Booked Rooms'" [nzPrefix]="prefixTplBooked"
            [nzValueStyle]="{ color: '#cf1322' }"></nz-statistic>
          <ng-template #prefixTplBooked><span nz-icon nzType="calendar"></span></ng-template>
          <nz-progress
            [nzPercent]="stats()!.totalRooms > 0 ? ((stats()!.bookedRooms / stats()!.totalRooms * 100) | number:'1.0-0') : 0"
            nzSize="small" nzStatus="exception"></nz-progress>
        </nz-card>
      </div>
    </div>

    <!-- Hotels Details Grid -->
    <div class="hotels-section" style="margin-top: 24px;">
      <h2>Hotels Overview</h2>
      <div nz-row [nzGutter]="16">
        <div nz-col [nzSpan]="8" *ngFor="let hotelStat of stats()!.hotelStats" style="margin-bottom: 16px;">
          <nz-card [nzTitle]="hotelStat.hotel.name" [nzExtra]="extraTemplate" [nzHoverable]="true"
            (click)="navigateToHotelDetail(hotelStat.hotel.id)">
            <ng-template #extraTemplate>
              <a (click)="$event.stopPropagation(); navigateToHotelDetail(hotelStat.hotel.id)">Details</a>
            </ng-template>
            <p><span nz-icon nzType="environment"></span> {{ hotelStat.hotel.city }}, {{ hotelStat.hotel.country }}</p>
            <p>{{ hotelStat.hotel.address }}</p>

            <div style="margin-top: 16px;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                <span>Occupancy</span>
                <span>{{ hotelStat.totalRooms > 0 ? (hotelStat.bookedRooms / hotelStat.totalRooms * 100 |
                  number:'1.0-0') : 0 }}%</span>
              </div>
              <nz-progress
                [nzPercent]="hotelStat.totalRooms > 0 ? (hotelStat.bookedRooms / hotelStat.totalRooms * 100) : 0"
                [nzShowInfo]="false"></nz-progress>
            </div>

            <div style="display: flex; justify-content: space-between; margin-top: 16px;">
              <nz-statistic [nzValue]="hotelStat.totalRooms" [nzTitle]="'Total'"
                [nzValueStyle]="{ fontSize: '16px' }"></nz-statistic>
              <nz-statistic [nzValue]="hotelStat.availableRooms" [nzTitle]="'Available'"
                [nzValueStyle]="{ fontSize: '16px', color: '#3f8600' }"></nz-statistic>
              <nz-statistic [nzValue]="hotelStat.bookedRooms" [nzTitle]="'Booked'"
                [nzValueStyle]="{ fontSize: '16px', color: '#cf1322' }"></nz-statistic>
            </div>
          </nz-card>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="stats()!.hotelStats.length === 0" class="empty-state">
        <nz-empty [nzNotFoundImage]="'simple'" [nzNotFoundContent]="'No hotels available yet'"
          [nzNotFoundFooter]="footerTpl">
          <ng-template #footerTpl>
            <button nz-button nzType="primary" (click)="navigateToAddHotel()">Create First Hotel</button>
          </ng-template>
        </nz-empty>
      </div>
    </div>
  </div>
</div>